<html> 
  <head> 
        <meta charset="utf-8"> 
        <title>HelloWorld</title> 
        <style>

  
  .axis path,
  .axis line{
    fill: none;
    stroke: black;
    shape-rendering: crispEdges;
  }

  .axis text {
    font-family: sans-serif;
    font-size: 11px;
  }

  .MyRect {

  }

  .MyText {
    fill: white;
    text-anchor: middle;
  }


        </style>
  </head> 
    <body> 
        
        <script src="d3_28.js" charset="utf-8"></script> 
        <script>  
        
//circle example
/*  //画布大小
  var width = 400;
  var height = 400;

  //在 body 里添加一个 SVG 画布 
  var svg = d3.select("body")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

  var circle1 = svg.append("circle")
          .attr("cx", 100)
          .attr("cy", 100)
          .attr("r", 45)
          .style("fill","green");

  //在1秒（1000毫秒）内将圆心坐标由100变为300
  circle1.transition()
    .duration(1000)
    .attr("cx", 300);

  var circle2 = svg.append("circle")
          .attr("cx", 100)
          .attr("cy", 200)
          .attr("r", 45)
          .style("fill","green");

  //在1.5秒（1500毫秒）内将圆心坐标由100变为300，
  //将颜色从绿色变为红色
  circle2.transition()
    .duration(1500)
    .attr("cx", 300)
    .style("fill","red");

  var circle3 = svg.append("circle")
          .attr("cx", 100)
          .attr("cy", 300)
          .attr("r", 45)
          .style("fill","green");

  //在2秒（2000毫秒）内将圆心坐标由100变为300
  //将颜色从绿色变为红色
  //将半径从45变成25
  //过渡方式采用bounce（在终点处弹跳几次）
  circle3.transition()
    .duration(2000)
    .ease("bounce")
    .attr("cx", 300)
    .style("fill","red")
    .attr("r", 25);*/


//会动的矩形
  /*//画布大小
  var width = 400;
  var height = 400;

  //在 body 里添加一个 SVG 画布 
  var svg = d3.select("body")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

  //画布周边的空白
  var padding = {left:30, right:30, top:20, bottom:20};

  //定义一个数组
  var dataset = [10, 20, 30, 40, 33, 24, 12, 5];
    
  //x轴的比例尺
  var xScale = d3.scale.ordinal()
    .domain(d3.range(dataset.length))
    .rangeRoundBands([0, width - padding.left - padding.right]);

  //y轴的比例尺
  var yScale = d3.scale.linear()
    .domain([0,d3.max(dataset)])
    .range([height - padding.top - padding.bottom, 0]);

  //定义x轴
  var xAxis = d3.svg.axis()
    .scale(xScale)
    .orient("bottom");
    
  //定义y轴
  var yAxis = d3.svg.axis()
    .scale(yScale)
    .orient("left");

  //矩形之间的空白
  var rectPadding = 4;

  //添加矩形元素
  var rects = svg.selectAll(".MyRect")
    .data(dataset)
    .enter()
    .append("rect")
    .attr("class","MyRect")
    .attr("transform","translate(" + padding.left + "," + padding.top + ")")
    .attr("x", function(d,i){
      return xScale(i) + rectPadding/2;
    } )
    .attr("width", xScale.rangeBand() - rectPadding )
    .attr("y",function(d){
      var min = yScale.domain()[0];
      return yScale(min);
    })
    .attr("height", function(d){
      return 0;
    })
    .transition()
    .delay(function(d,i){
      return i * 200;
    })
    .duration(2000)
    .ease("bounce")
    .attr("y",function(d){
      return yScale(d);
    })
    .attr("height", function(d){
      return height - padding.top - padding.bottom - yScale(d);
    });

  //添加文字元素
  var texts = svg.selectAll(".MyText")
    .data(dataset)
    .enter()
    .append("text")
    .attr("class","MyText")
    .attr("transform","translate(" + padding.left + "," + padding.top + ")")
    .attr("x", function(d,i){
      return xScale(i) + rectPadding/2;
    } )
    .attr("dx",function(){
      return (xScale.rangeBand() - rectPadding)/2;
    })
    .attr("dy",function(d){
      return 20;
    })
    .text(function(d){
      return d;
    })
    .attr("y",function(d){
      var min = yScale.domain()[0];
      return yScale(min);
    })
    .transition()
    .delay(function(d,i){
      return i * 200;
    })
    .duration(2000)
    .ease("bounce")
    .attr("y",function(d){
      return yScale(d);
    });

  //添加x轴
  svg.append("g")
    .attr("class","axis")
    .attr("transform","translate(" + padding.left + "," + (height - padding.bottom) + ")")
    .call(xAxis); 
    
  //添加y轴
  svg.append("g")
    .attr("class","axis")
    .attr("transform","translate(" + padding.left + "," + padding.top + ")")
    .call(yAxis);*/


//交互
  /*//画布大小
  var width = 400;
  var height = 400;

  //在 body 里添加一个 SVG 画布 
  var svg = d3.select("body")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

  //画布周边的空白
  var padding = {left:30, right:30, top:20, bottom:20};

  //定义一个数组
  var dataset = [10, 20, 30, 40, 33, 24, 12, 5];
    
  //x轴的比例尺
  var xScale = d3.scale.ordinal()
    .domain(d3.range(dataset.length))
    .rangeRoundBands([0, width - padding.left - padding.right]);

  //y轴的比例尺
  var yScale = d3.scale.linear()
    .domain([0,d3.max(dataset)])
    .range([height - padding.top - padding.bottom, 0]);

  //定义x轴
  var xAxis = d3.svg.axis()
    .scale(xScale)
    .orient("bottom");
    
  //定义y轴
  var yAxis = d3.svg.axis()
    .scale(yScale)
    .orient("left");

  //矩形之间的空白
  var rectPadding = 4;

  //添加矩形元素
  var rects = svg.selectAll(".MyRect")
    .data(dataset)
    .enter()
    .append("rect")
    .attr("class","MyRect")
    .attr("transform","translate(" + padding.left + "," + padding.top + ")")
    .attr("x", function(d,i){
      return xScale(i) + rectPadding/2;
    } )
    .attr("y",function(d){
      return yScale(d);
    })
    .attr("width", xScale.rangeBand() - rectPadding )
    .attr("height", function(d){
      return height - padding.top - padding.bottom - yScale(d);
    })
    .attr("fill","steelblue")   //填充颜色不要写在CSS里
    .on("mouseover",function(d,i){
      d3.select(this)
        .attr("fill","yellow");
    })
    .on("mouseout",function(d,i){
      d3.select(this)
        .transition()
            .duration(500)
        .attr("fill","steelblue");
    });

  //添加文字元素
  var texts = svg.selectAll(".MyText")
    .data(dataset)
    .enter()
    .append("text")
    .attr("class","MyText")
    .attr("transform","translate(" + padding.left + "," + padding.top + ")")
    .attr("x", function(d,i){
      return xScale(i) + rectPadding/2;
    } )
    .attr("y",function(d){
      return yScale(d);
    })
    .attr("dx",function(){
      return (xScale.rangeBand() - rectPadding)/2;
    })
    .attr("dy",function(d){
      return 20;
    })
    .text(function(d){
      return d;
    });

  //添加x轴
  svg.append("g")
    .attr("class","axis")
    .attr("transform","translate(" + padding.left + "," + (height - padding.bottom) + ")")
    .call(xAxis); 
    
  //添加y轴
  svg.append("g")
    .attr("class","axis")
    .attr("transform","translate(" + padding.left + "," + padding.top + ")")
    .call(yAxis);*/


    //饼状图
    /*var width = 400;
    var height = 400;
    var dataset = [ 30 , 10 , 43 , 55 , 13 ];
    
    var svg = d3.select("body")
          .append("svg")
          .attr("width", width)
          .attr("height", height);
    
    var pie = d3.layout.pie();

    var piedata = pie(dataset);
    
    var outerRadius = 150;  //外半径
    var innerRadius = 0;  //内半径，为0则中间没有空白

    var arc = d3.svg.arc()  //弧生成器
          .innerRadius(innerRadius) //设置内半径
          .outerRadius(outerRadius);  //设置外半径
    
    var color = d3.scale.category10();
    
    var arcs = svg.selectAll("g")
            .data(piedata)
            .enter()
            .append("g")
            .attr("transform","translate("+ (width/2) +","+ (width/2) +")");
            
    arcs.append("path")
      .attr("fill",function(d,i){
        return color(i);
      })
      .attr("d",function(d){
        return arc(d);
      });
    
    arcs.append("text")
      .attr("transform",function(d){
        return "translate(" + arc.centroid(d) + ")";
      })
      .attr("text-anchor","middle")
      .text(function(d){
        return d.data;
      });
    
    console.log(dataset);
    console.log(piedata);*/


       //力图      
    /*var nodes = [ { name: "桂林"    }, { name: "广州" },
            { name: "厦门"    }, { name: "杭州"   },
            { name: "上海"   }, { name: "青岛"    },
            { name: "天津"    } ];
           
    var edges = [  { source : 0  , target: 1 } , { source : 0  , target: 2 } ,
             { source : 0  , target: 3 } , { source : 1  , target: 4 } ,
             { source : 1  , target: 5 } , { source : 1  , target: 6 }  ];  
    
    var width = 400;
    var height = 400;
    
    
    var svg = d3.select("body")
          .append("svg")
          .attr("width",width)
          .attr("height",height);
    
    var force = d3.layout.force()
        .nodes(nodes)   //指定节点数组
        .links(edges)   //指定连线数组
        .size([width,height]) //指定范围
        .linkDistance(150)  //指定连线长度
        .charge([-400]);  //相互之间的作用力

    force.start();  //开始作用

    console.log(nodes);
    console.log(edges);
    
    //添加连线    
    var svg_edges = svg.selectAll("line")
              .data(edges)
              .enter()
              .append("line")
              .style("stroke","#ccc")
              .style("stroke-width",1);
    
    var color = d3.scale.category20();
        
    //添加节点      
    var svg_nodes = svg.selectAll("circle")
              .data(nodes)
              .enter()
              .append("circle")
              .attr("r",20)
              .style("fill",function(d,i){
                return color(i);
              })
              .call(force.drag);  //使得节点能够拖动

    //添加描述节点的文字
    var svg_texts = svg.selectAll("text")
              .data(nodes)
              .enter()
              .append("text")
              .style("fill", "black")
              .attr("dx", 20)
              .attr("dy", 8)
              .text(function(d){
                return d.name;
              });
          

    force.on("tick", function(){  //对于每一个时间间隔
    
       //更新连线坐标
       svg_edges.attr("x1",function(d){ return d.source.x; })
          .attr("y1",function(d){ return d.source.y; })
          .attr("x2",function(d){ return d.target.x; })
          .attr("y2",function(d){ return d.target.y; });
       
       //更新节点坐标
       svg_nodes.attr("cx",function(d){ return d.x; })
          .attr("cy",function(d){ return d.y; });

       //更新文字坐标
       svg_texts.attr("x", function(d){ return d.x; })
        .attr("y", function(d){ return d.y; });
    });*/


//json连接图
/*var width = 500,
height = 500;

var tree = d3.layout.tree()
  .size([width, height-200])
  .separation(function(a, b) { return (a.parent == b.parent ? 1 : 2); });

var diagonal = d3.svg.diagonal()
  .projection(function(d) { return [d.y, d.x]; });

var svg = d3.select("body").append("svg")
  .attr("width", width)
  .attr("height", height)
  .append("g")
  .attr("transform", "translate(40,0)");



d3.json("city_tree.json", function(error, root) {

  var nodes = tree.nodes(root);
  var links = tree.links(nodes);
  
  console.log(nodes);
  console.log(links);
  
  var link = svg.selectAll(".link")
    .data(links)
    .enter()
    .append("path")
    .attr("class", "link")
    .attr("d", diagonal);
  
  var node = svg.selectAll(".node")
    .data(nodes)
    .enter()
    .append("g")
    .attr("class", "node")
    .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; })
  
  node.append("circle")
    .attr("r", 4.5);
  
  node.append("text")
    .attr("dx", function(d) { return d.children ? -8 : 8; })
    .attr("dy", 3)
    .style("text-anchor", function(d) { return d.children ? "end" : "start"; })
    .text(function(d) { return d.name; });
  });*/

  var width  = 1000;
  var height = 1000;
  
  var svg = d3.select("body").append("svg")
      .attr("width", width)
      .attr("height", height)
      .append("g")
      .attr("transform", "translate(0,0)");
  
  var projection = d3.geo.mercator()
            .center([107, 31])
            .scale(850)
              .translate([width/2, height/2]);
  
  var path = d3.geo.path()
          .projection(projection);
  
  
  var color = d3.scale.category20();
  
  
  d3.json("china.geojson", function(error, root) {
    
    if (error) 
      return console.error(error);
    console.log(root.features);
    
    svg.selectAll("path")
      .data( root.features )
      .enter()
      .append("path")
      .attr("stroke","#000")
      .attr("stroke-width",1)
      .attr("fill", function(d,i){
        return color(i);
      })
      .attr("d", path )
      .on("mouseover",function(d,i){
                d3.select(this)
                    .attr("fill","yellow");
            })
            .on("mouseout",function(d,i){
                d3.select(this)
                    .attr("fill",color(i));
            });
    
  });




      
        
      
        






        </script> 
    </body> 
</html>